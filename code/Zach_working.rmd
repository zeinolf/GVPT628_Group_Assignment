---
title: "SURV628 Group Assignment Code"
author: "Zach Einolf"
date: "10/07/2025"
output:
  pdf_document:
    latex_engine: xelatex
---

```{r, echo=FALSE} 
library(tidyverse)
library(srvyr)
library(gssr)
library(gssrdoc)
library(haven)
```


```{r}
ess<- read_dta("ESS11.dta")
```

```{r}
ess_small <- ess |> 
  dplyr::select(idno, atcherp, atchctr, cntry, region, vteurmmb, domicil,
         psu, stratum, anweight) |> 
  mutate(
    atcherp  = as.numeric(atcherp),
    atchctr = as.numeric(atchctr),
    cntry = as_factor(cntry),
    region = as_factor(region),
    vteurmmb = as_factor(vteurmmb),
    domicil = as.numeric(domicil),
    country_vs_europe = atchctr - atchctr
  ) |> 
  filter(!is.na(anweight), !is.na(psu), !is.na(stratum))
```

```{r}
ess_w <- svydesign(
  ids = ~psu,
  strata = ~stratum,
  weights = ~anweight,
  data = ess_small,
  nest = TRUE
)
```